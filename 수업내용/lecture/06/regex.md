# 정규표현식 (Regular Expression)

- 특정한 규칙을 가진 문자열의 집합을 표현하기 위해 쓰이는 형식언어
- 텍스트 내 특정한 형태나 규칙을 가지는 문자열을 찾기 위한 패턴

- 활용 사례
    - 데이터 유효성 검사 (휴대폰, 이메일, 시간 등등)
    - 데이터 스크래핑 (웹에서 특정 패턴으로 정보 스크랩)
    - 문자열 파싱 (URL 파싱, 괄호 파싱 등등)
    - 문자열 대체 (;를 ,로 변경, 대소문자 변경 등등)
    - 그 외 파일명 변경, 패킷 스니핑 등 문자열을 다루는 여러 응용로직에서 사용

# 정규표현식 메타문자

- ^
    - 문자열의 시작을 표현
    - [ ... ] 내부에서 쓰이는 경우라면 뒤의 패턴에 일치하지 않는 것 (NOT)
    - 예시
        - ^http
            - 문자열이 http로 시작하는 경우에만 매치, 중간에 나타난 http에는 매치하지 않음
        - ab[^0-9]
            - "ab" 뒤에 숫자가 아닌 것이 오는 것에만 매치 ("abc" – O, "ab1" – X)

- $
    - 문자열의 끝을 표현
    - 예시
        - them$
            - 문자열이 “them”으로 끝난 경우에만 해당 “them”에 매치

- \b
    - 단어의 경계
    - 문자열 시작과 끝, 공백, 개행, 탭, 콤마, 구두점, 대시문자 등이 올 수 있음
    - 예시
        - \bplay\b
            - 단어 경계로 구분되는 “play”에는 매치, 하지만 “playground”의 “play”에는 매치하지 않음

- \B
    - \b가 아님
    - 참고로 정규표현식 메타문자에서는 흔히 대문자로 표현한 것은 소문자로 표현한 문자의 반대를 의미
    - 예시
        - \bplay\B
            - "play" 뒤에 단어의 경계가 아닌 것이 올 때에만 매치
            - "playground", "playball"의 "play"에 매치
            - 뒤에 오는 "g", "b" 등의 문자는 포함하지 않음

- \s
    - 공백 문자 및 탭 문자에 매치

- \S
    - 공백 문자가 아닌 한 글자에 매치

- \d
    - 숫자에 매치, [0-9]와 같음

- \D
    - 숫자가 아닌 문자에 매치, [^0-9]와 같음

- \w
    - 단어를 만들 수 있는 글자
    - 알파벳 대소문자, 숫자, 언더스코어를 포함하며, [A-Za-z0-9_]와 같음

- \W
    - \w에 포함되지 않는 문자들

- \n
    - 개행문자 (참고로 \r은 캐리지 리턴)

- \
    - 이스케이프용 문자
    - 정규표현식 상의 특별한 의미가 있는 문자들을 문자 그대로 쓸 때 앞에 붙임
    - 예를 들어, \^ 라고 쓰면 "^" 문자 그대로를 의미함

- .
    - 아무 문자 1개에 대응, 공백 역시 문자 1개로 취급함

# 선택 패턴

- |
    - A | B 의 패턴으로 A 혹은 B에 매칭할 수 있음
    - 예를 들어 tomato와 potato에 모두 매칭하고 싶다면 tomato|potato 라고 쓸 수 있음

- [ ... ]
    - 대괄호 속에 넣은 문자 중에서 하나에 매치
    - 예를 들어, [cfh]all 이라는 패턴은 call, fall, hall에 모두 매치될 수 있음
    - 특히 선택 패턴은 A-B를 통해서 특정 범위를 표현할 수도 있음
        - 숫자의 경우 [0-9]
        - 알파벳 소문자의 경우 [a-z]
        - 알파벳대문자의 경우 [A-Z]
    - 또한 선택 패턴 내에서 ^ 이 쓰이면 not 의 의미가 되며, 이 문자 뒤에 오는 문자들은 제외하게 됨
        - [^cfh]all 은 앞서 나온 call, fall, hall에는 매치하지 않으며 mall에는 매치하게 됨

    - 예시
        - [abc]
            - a 또는 b 또는 c를 의미하며, a|b|c와 동일
        - [a-c]
            - 위와 동일
        - [a-fA-F0-9]
            - 16진수의 문자 하나와 매칭하고 대소문자를 구분하지 않음
        - [0-9]%
            - 0 이상 9 이하 숫자 그리고 % 문자를 포함한 문자열과 매치
        - [^a-zA-Z]
            - 영문이 아닌 문자와 매치

# 그룹

- ( )
    - 괄호로 둘러싼 단위는 그룹을 나타냄
    - 그룹은 전체 패턴 내에서 다시 하나로 묶여지는 패턴 조각을 나타냄
    - 특히, | 나 뒤에 나오는 수량 한정자를 그룹에 붙이는 형태로 많이 사용됨
    - 한 번 매치한 그룹이 다시 반복되어 나타나는 경우에도 사용할 수 있음
    - 예시
        - (tom|pot)ato
            - tomato, potato에 모두 매치되는 패턴을 그룹을 써서 좀 더 줄임
        - (a|i){3}bc
            - a 혹은 i가 3개 온 후에 bc가 오는 패턴
            - aaabc, iiibc, aiabc, aaibc, iiabc 등에 매치

    - 괄호를 써서 묶은 부분은 1번부터 시작하는 그룹으로 참조
    - 앞서 매치한 그룹을 패턴 내에서 재사용하려면 \1과 같이 그룹번호를 역슬래시로 이스케이프하여 표현
    - 예시
        - (a|b|c){2}ma\1
            - a 혹은 b 혹은 c 중에서 매치되는 두 글자를 그룹으로 캡쳐하고 ma 뒤에 동일한 글자가 반복되는 패턴
            - aamaaa, bcmabc, abmaab 등에 매치
            - 캡쳐된 그룹을 재사용하는 패턴은 그룹의 패턴이 아닌 캡쳐된 내용에 매치하므로 aamabb에는 매치되지 않음

# 수량 한정자

- 동일한 글자 혹은 동일한 족(family)이 n 개 만큼 나오는 경우에 수량한정자를 뒤에 붙일 수 있음

- ?
    - 바로 앞의 글자 혹은 그룹이 1개 혹은 0개
    - 예시: apples?
        - s?는 "s"가 있을 수도 있고, 없을 수도 있다는 의미로, "apple", "apples" 모두에 매치
- \*
    - 0개 이상
    - 예시: n\d*
        - n 뒤에 숫자가 0개 이상이라는 의미로, "n", "n1", "n123" 에 모두 매치

- \+
    - 1개 이상
    - 예시: n\d+
        - "n" 뒤에 숫자가 1개 이상으로, "n1", "n123"에 매치되지만 "n" 에는 매치되지 않음

- {n}
    - n 개
    - 예시: n\d{2}$
        - "n" 뒤에 숫자가 2개 있음을 의미
        - "n12" 에 매치되지만, "n", "n1", "n123"에는 매치되지 않음
        - n\d{2}라고 했을 때에 "n123"에서는 "n12" 까지만 매치하고 3은 제외

- {n, m}
    - n개 이상, m개 이하
    - 예시: n\d{2, 3}$
        - "n12", "n123"에는 매치되지만 "n1"이나 "n1234"에는 매치되지 않음
    - m은 생략가능하며, 생략되면 n개 이상이라는 의미가 됨

- Greedy and Lazy match

    - <.+>
        - <와 > 사이 하나 이상의 문자와 매칭
        - "This is a \<div\> simple div \</div\> test"에서 "\<div\> simple div \</div\>"와 매치
    
    - <.+?>
        - <와 > 사이 하나 이상의 문자와 매칭하지만, 가능한 짧게 매칭
        - "This is a \<div\> simple div \</div\> test"에서 "\<div\>"와 매치

    - <[^<>]+>
        - < 와 > 사이에 <,>가 아닌 모든 문자가 하나 이상인 문자와 매칭
        - "This is a \<div\> simple div \</div\> test"에서 "\<div\>"와 매치

# 실습 (regex101.com)

- 파일 확장자

    - 조건
        - jpg, gif, png 확장자를 가지는 그림 파일명
        - picture.jpg, motion.gif, image.png와 같이 씀

- 핸드폰 번호

    - 조건
        - 010-1234-5678과 같이 쓰고 구분자는 없을 수도 있고, 공백일 수도 있음
        - 예전 핸드폰 번호의 경우 011, 016, 017, 018, 019로 시작할 수 있으며, 가운데 자리가 3자리만 있는 번호도 있음

- 주민등록번호

    - 조건
        - XXXXXX-XXXXXXX 형태
        - 앞/뒷자리를 구분하는 하이픈("-")은 없을 수도 있음
        - 주민번호 생년월일 중 월은 1~12, 일은 1~31 값이 들어올 수 있음
        - 주민번호 뒷자리 첫글자는 1~4만 갖음

- 이메일 주소

    - 조건
        - jaehyun.nam@dankook.ac.kr, jn@boanlab.com과 같은 형태로 구성
        - 아이디의 첫 글자는 "-", "_", "."가 아닌 영문자와 숫자만 가능
        - 아이디의 다른 글자는 영문자, 숫자, "-", "_", "."으로 구성
        - 도메인의 첫 글자와 마지막 글자는 "-"가 아닌 영문자, 숫자로 구성
        - 도메인 길이는 2자 이상 63자 이하여야 함
